(()=>{!function e(){if(document.head){const e=document.createElement("link");e.rel="stylesheet",e.href=window.chrome.runtime.getURL("blocked-page.css"),document.head.appendChild(e)}else setTimeout(e,10)}();const e=["facebook.com","www.facebook.com","instagram.com","www.instagram.com","reddit.com","www.reddit.com","tiktok.com","www.tiktok.com"],n=["youtube.com","www.youtube.com","twitter.com","www.twitter.com","x.com","www.x.com"];function o(){const e=window.location.hostname.toLowerCase(),n=window.location.pathname,o=window.location.search;return e.includes("youtube.com")?"/watch"===n&&o.includes("v="):!(!e.includes("twitter.com")&&!e.includes("x.com"))&&(n.includes("/status/")||n.includes("/tweet/"))}function t(e,n){try{if(!document.body||!document.head)return void setTimeout(()=>t(e,n),100);const o=document.getElementById("focus-mode-overlay");o&&o.remove(),function(){if(window.location.hostname.toLowerCase().includes("youtube.com"))try{const e=document.querySelector("video");if(e&&!e.paused)return e.pause(),console.log("Video paused using video element"),!0;if(window.ytplayer&&window.ytplayer.pauseVideo)return window.ytplayer.pauseVideo(),console.log("Video paused using YouTube player API"),!0;const n=document.querySelector(".ytp-play-button[aria-label*='Pause']");if(n)return n.click(),console.log("Video paused by clicking pause button"),!0;const o=document.querySelector("#movie_player, .html5-video-player");if(o){const e=new KeyboardEvent("keydown",{key:" ",code:"Space",keyCode:32,which:32,bubbles:!0});return o.dispatchEvent(e),console.log("Attempted to pause video with spacebar"),!0}}catch(e){return console.error("Error pausing video:",e),!1}return!1}()&&console.log("Video paused before showing overlay"),setTimeout(()=>{!function(e,n){try{const o=function(e){return e&&0!==e.length?e.map(e=>`<span style="padding: 0.375rem 0.75rem; background: #dbeafe; color: #1e40af; font-size: 0.875rem; font-weight: 500; border-radius: 9999px;">${e}</span>`).join(" "):'<span style="padding: 0.375rem 0.75rem; background: #f3f4f6; color: #6b7280; font-size: 0.875rem; border-radius: 9999px;">None set</span>'}(n),t=document.createElement("div");t.id="focus-mode-overlay",t.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 2147483647;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  ",t.innerHTML=`\n    <div style="\n      background: white;\n      border-radius: 12px;\n      border: 1px solid #f3f4f6;\n      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n      max-width: 40rem;\n      margin: 0 1.5rem;\n      width: 100%;\n      max-height: 90vh;\n      overflow-y: auto;\n    ">\n      <div style="padding: 2rem; text-align: center;">\n        \x3c!-- Icon and Header --\x3e\n        <div style="\n          width: 4rem;\n          height: 4rem;\n          background: linear-gradient(135deg, #3b82f6, #8b5cf6);\n          border-radius: 50%;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          margin: 0 auto 1.5rem auto;\n        ">\n          <svg style="width: 2rem; height: 2rem; color: white;" fill="currentColor" viewBox="0 0 20 20">\n            <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"></path>\n          </svg>\n        </div>\n        \n        <h1 style="font-size: 1.5rem; font-weight: 600; color: #111827; margin-bottom: 1.5rem;">Content Not Aligned with Your Focus</h1>\n        \n        \x3c!-- Content Info --\x3e\n        <div style="\n          background: #f9fafb;\n          border: 1px solid #f3f4f6;\n          border-radius: 12px;\n          padding: 1.5rem;\n          margin-bottom: 1.5rem;\n          text-align: left;\n        ">\n          <div style="margin-bottom: 1rem;">\n            <p style="font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.5rem;">Your Focus Areas:</p>\n            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">${o}</div>\n          </div>\n          <div>\n            <p style="font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.25rem;">Current Content:</p>\n            <p style="font-size: 0.875rem; color: #4b5563;">"${e}"</p>\n          </div>\n        </div>\n        \n        \x3c!-- Motivational Quote --\x3e\n        <div style="\n          background: #eff6ff;\n          border: 1px solid #dbeafe;\n          border-radius: 12px;\n          padding: 1rem;\n          margin-bottom: 1.5rem;\n        ">\n          <p style="font-size: 0.875rem; font-style: italic; color: #1e3a8a;">"Success is the result of preparation, hard work, and learning from failure." - Colin Powell</p>\n        </div>\n        \n        \x3c!-- Action Buttons --\x3e\n        <div style="display: flex; gap: 0.75rem; justify-content: center; margin-bottom: 1.5rem;">\n          <button id="goBackBtn" style="\n            padding: 0.625rem 1.5rem;\n            background: #111827;\n            color: white;\n            font-size: 0.875rem;\n            font-weight: 500;\n            border-radius: 12px;\n            border: none;\n            cursor: pointer;\n            transition: background-color 0.2s;\n          ">\n            Take Me Back\n          </button>\n          <button id="continueBtn" style="\n            padding: 0.625rem 1.5rem;\n            background: #e5e7eb;\n            color: #374151;\n            font-size: 0.875rem;\n            font-weight: 500;\n            border-radius: 12px;\n            border: none;\n            cursor: not-allowed;\n            opacity: 0.5;\n            transition: all 0.2s;\n          " disabled>\n            Continue Anyway (<span id="countdown">120</span>s)\n          </button>\n        </div>\n        \n        \x3c!-- Justification Section --\x3e\n        <div id="justificationSection" style="display: none;">\n          <div style="border-top: 1px solid #f3f4f6; padding-top: 1.5rem;">\n            <h3 style="font-size: 1.125rem; font-weight: 500; color: #111827; margin-bottom: 1rem;">Why do you need to view this content?</h3>\n            <textarea id="justificationText" placeholder="Explain why this content is necessary for your current focus..." style="\n              width: 100%;\n              height: 6rem;\n              padding: 0.75rem;\n              font-size: 0.875rem;\n              border: 1px solid #d1d5db;\n              border-radius: 12px;\n              resize: none;\n              margin-bottom: 1rem;\n              box-sizing: border-box;\n            "></textarea>\n            <button id="submitJustification" style="\n              width: 100%;\n              padding: 0.625rem 1.5rem;\n              background: #2563eb;\n              color: white;\n              font-size: 0.875rem;\n              font-weight: 500;\n              border-radius: 12px;\n              border: none;\n              cursor: pointer;\n              transition: background-color 0.2s;\n            ">\n              Submit & Continue\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  `,document.body?document.body.appendChild(t):document.documentElement.appendChild(t);const i=document.getElementById("goBackBtn"),r=document.getElementById("continueBtn"),c=document.getElementById("justificationSection"),d=document.getElementById("submitJustification"),s=document.getElementById("countdown");i.addEventListener("click",()=>{window.history.back()});let a=120;const l=setInterval(()=>{a--,s.textContent=a,a<=0&&(clearInterval(l),r.disabled=!1,r.innerHTML="Continue Anyway")},1e3);r.addEventListener("click",()=>{r.disabled||(c.style.display="block",r.style.display="none")}),d.addEventListener("click",()=>{const e=document.getElementById("justificationText").value.trim();e.length<20?alert("Please provide a more detailed justification (at least 20 characters)"):(console.log("User justification:",e),t.remove())})}catch(e){console.error("Error creating overlay DOM:",e),function(){try{const e=document.createElement("div");e.id="focus-mode-overlay",e.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.8);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 2147483647;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    ",e.innerHTML='\n      <div style="\n        background: white;\n        padding: 40px;\n        border-radius: 12px;\n        text-align: center;\n        max-width: 500px;\n        margin: 20px;\n      ">\n        <h2 style="margin: 0 0 20px 0; color: #333;">Content Not Aligned with Your Focus</h2>\n        <p style="margin: 0 0 20px 0; color: #666;">This content doesn\'t match your current focus areas.</p>\n        <button id="simple-go-back" style="\n          background: #333;\n          color: white;\n          border: none;\n          padding: 12px 24px;\n          border-radius: 6px;\n          cursor: pointer;\n          margin-right: 10px;\n        ">Go Back</button>\n        <button id="simple-continue" style="\n          background: #ccc;\n          color: #333;\n          border: none;\n          padding: 12px 24px;\n          border-radius: 6px;\n          cursor: pointer;\n        ">Continue Anyway</button>\n      </div>\n    ',document.body.appendChild(e),document.getElementById("simple-go-back").addEventListener("click",()=>{window.history.back()}),document.getElementById("simple-continue").addEventListener("click",()=>{e.remove()})}catch(e){console.error("Error creating simple overlay:",e)}}()}}(e,n)},250)}catch(o){console.error("Error creating motivational overlay:",o),setTimeout(()=>t(e,n),1e3)}}function i(){if(!document.documentElement)return void setTimeout(i,100);document.head.innerHTML='\n    <title>Site Blocked - Focus Mode</title>\n    <meta charset="utf-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  ';const e=document.createElement("link");e.rel="stylesheet",e.href=window.chrome.runtime.getURL("blocked-page.css"),document.head.appendChild(e),document.body.className="blocked-page-body",document.body.innerHTML=`\n    <div class="blocked-page-container">\n      \x3c!-- Icon --\x3e\n      <div class="blocked-page-icon blocked-page-icon-red">\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"/><path d="M128,60a20,20,0,0,1,40,0v56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M88,76V44a20,20,0,0,1,40,0v68" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M128,176a40,40,0,0,1,40-40V116a20,20,0,0,1,40,0v36a80,80,0,0,1-160,0V76a20,20,0,0,1,40,0v44" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/></svg>l\n      </div>\n      \n      \x3c!-- Header --\x3e\n      <h1 class="blocked-page-title">Site Completely Blocked</h1>\n      \n      \x3c!-- Content --\x3e\n      <p class="blocked-page-description">\n        <span class="blocked-page-domain">${window.location.hostname}</span> is completely blocked while Focus Mode is active.\n      </p>\n      <p class="blocked-page-subtitle">This site is known to be highly distracting and doesn't support content evaluation.</p>\n      \n      \x3c!-- Motivational Quote --\x3e\n      <div class="blocked-page-quote">\n        <p class="blocked-page-quote-text">"The successful warrior is the average person with laser-like focus." - Bruce Lee</p>\n      </div>\n      \n      \x3c!-- Action Buttons --\x3e\n      <div class="blocked-page-buttons">\n        <button id="closeTabBtn" class="blocked-page-btn blocked-page-btn-primary">\n          Close Tab\n        </button>\n      </div>\n    </div>\n  `,setTimeout(()=>{const e=document.getElementById("closeTabBtn");e&&e.addEventListener("click",()=>{try{window.close(),setTimeout(()=>{window.chrome&&window.chrome.runtime?window.chrome.runtime.sendMessage({action:"closeTab"}).catch(()=>{window.location.href="about:blank"}):window.location.href="about:blank"},100)}catch(e){console.error("Error closing tab:",e),window.location.href="about:blank"}})},100)}async function r(){try{if(!document.body||!document.head)return void setTimeout(r,100);console.log("Handling focus mode for:",window.location.href);const c=await window.chrome.storage.local.get(["focusMode","focusAreas","siteToggles"]),d=c.focusMode||!1,s=c.focusAreas||[],a=c.siteToggles||{};if(console.log("Focus mode:",d,"Focus areas:",s,"Site toggles:",a),!d)return;const l=window.location.hostname.toLowerCase(),u=function(o,t){const i=[o,o.startsWith("www.")?o.substring(4):`www.${o}`];for(const e of i)if(t.hasOwnProperty(e))return t[e];return e.includes(o)||e.includes(`www.${o}`)||e.includes(o.replace("www.",""))?"blocked":n.includes(o)||n.includes(`www.${o}`)||n.includes(o.replace("www.",""))?"smart":"allowed"}(l,a);if(console.log("Current domain:",l,"Toggle state:",u),"allowed"===u)return void console.log("Site is set to allowed, skipping blocking/evaluation");if("blocked"===u||function(){const n=window.location.hostname.toLowerCase();return e.some(e=>n===e||n.endsWith("."+e))}())return console.log("Site should be completely blocked"),void i();("smart"===u||function(){const e=window.location.hostname.toLowerCase();return n.some(n=>e===n||e.endsWith("."+n))}())&&o()?(console.log("Site should have content evaluated and we're on specific content"),setTimeout(async()=>{const e=function(){const e=window.location.hostname.toLowerCase();let n="";if(e.includes("youtube.com")){if(!o())return"";const e=["h1.ytd-video-primary-info-renderer","h1.title.style-scope.ytd-video-primary-info-renderer",'h1[class*="title"]',".title.style-scope.ytd-video-primary-info-renderer","h1.style-scope.ytd-video-primary-info-renderer","yt-formatted-string.style-scope.ytd-video-primary-info-renderer","#container h1",".ytd-video-primary-info-renderer h1","h1.ytd-watch-metadata","yt-formatted-string#title",".ytd-watch-metadata h1"];for(const o of e){const e=document.querySelector(o);if(e&&e.textContent.trim()){n=e.textContent.trim();break}}if(!n||n.length<5){const e=document.querySelector("#description-text, .ytd-video-secondary-info-renderer");if(e){const o=e.textContent.trim().substring(0,100);o&&(n=`${n||"Video"}: ${o}`)}}}else if(e.includes("twitter.com")||e.includes("x.com")){if(!o())return"";const e=document.querySelector('[data-testid="tweetText"]');e&&(n=e.textContent.trim())}return console.log("Extracted content:",n),n}();if(console.log("Extracted content:",e),e&&e.length>5&&s.length>0)try{const n=await window.chrome.runtime.sendMessage({action:"evaluateContent",content:e,focusAreas:s});console.log("Evaluation response:",n),n&&!n.isRelevant?(console.log("Content is not relevant, showing overlay"),t(e,s)):console.log("Content is relevant, allowing access")}catch(e){console.error("Error sending message to background:",e)}else console.log("No meaningful content found or no focus areas set")},3e3)):console.log("Not evaluating content - either not a monitored site or not on specific content")}catch(e){console.error("Error handling focus mode:",e)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r();let c=location.href;new MutationObserver(()=>{const e=location.href;e!==c&&(c=e,console.log("URL changed to:",e),setTimeout(r,2e3))}).observe(document,{subtree:!0,childList:!0}),window.chrome.storage.onChanged.addListener((e,n)=>{"local"===n&&(e.focusMode||e.focusAreas)&&(console.log("Storage changed, re-evaluating"),r())})})();
//# sourceMappingURL=content.bundle.js.map